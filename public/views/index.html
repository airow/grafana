<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
  <meta name="theme-color" content="#000">

  <title>大数据可视化平台</title>

  <link href='[[.AppSubUrl]]/public/css/fonts.min.css' rel='stylesheet' type='text/css'>
  <!-- <link href='https://raw.githubusercontent.com/daneden/animate.css/master/animate.css' rel='stylesheet' type='text/css'> -->
  <!-- <link href='[[.AppSubUrl]]/public/vendor/me-pageloading-0.4.1/me-pageloading.css' rel='stylesheet' type='text/css'> -->

  [[if .User.LightTheme]]
  <link rel="stylesheet" href="[[.AppSubUrl]]/public/css/grafana.light.min.css">
  [[else]]
  <!-- <link rel="stylesheet" href="[[.AppSubUrl]]/public/css/grafana.dark.min.css"> -->
  <link rel="stylesheet" href="[[.AppSubUrl]]/public/css/grafana.[[.User.ThemeName]].min.css">
  [[end]]

  <!--<link rel="icon" type="image/png" href="[[.AppSubUrl]]/public/img/fav32.png">-->
  <link rel="icon" type="image/png" href="[[.AppSubUrl]]/public/img/ddd/t-grafana.png">
  <!-- <link rel="shortcut icon" type="image/png" href="//resource.teld.cn/platform/teld/img/teld.ico"> -->
  <base href="[[.AppSubUrl]]/" />
  <style scoped>
    #grafHostLoadingContainer {
      height: 100%;
      width: 100%;
      position: fixed;
      /* background-color: white; */
    }

    #grafHostLoading {
      /* padding-top:100px;  */
      position: fixed;
      left: 50%;
      top: 50%;
    }

    .loader {
      position: absolute;
      top: calc(50% - 1.25em);
      left: calc(50% - 1.25em);
      width: 2.5em;
      height: 2.5em;
      transform: rotate(165deg);
    }

    .loader:before,
    .loader:after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      display: block;
      width: 0.5em;
      height: 0.5em;
      border-radius: 0.25em;
      transform: translate(-50%, -50%);
    }

    .loader:before {
      animation: before 2s infinite;
    }

    .loader:after {
      animation: after 2s infinite;
    }

    @keyframes before {
      0% {
        width: 0.5em;
        box-shadow: 1em -0.5em rgba(225, 20, 98, 0.75),
          -1em 0.5em rgba(111, 202, 220, 0.75);
      }

      35% {
        width: 2.5em;
        box-shadow: 0 -0.5em rgba(225, 20, 98, 0.75),
          0 0.5em rgba(111, 202, 220, 0.75);
      }

      70% {
        width: 0.5em;
        box-shadow: -1em -0.5em rgba(225, 20, 98, 0.75),
          1em 0.5em rgba(111, 202, 220, 0.75);
      }

      100% {
        box-shadow: 1em -0.5em rgba(225, 20, 98, 0.75),
          -1em 0.5em rgba(111, 202, 220, 0.75);
      }
    }

    @keyframes after {
      0% {
        height: 0.5em;
        box-shadow: 0.5em 1em rgba(61, 184, 143, 0.75),
          -0.5em -1em rgba(233, 169, 32, 0.75);
      }

      35% {
        height: 2.5em;
        box-shadow: 0.5em 0 rgba(61, 184, 143, 0.75),
          -0.5em 0 rgba(233, 169, 32, 0.75);
      }

      70% {
        height: 0.5em;
        box-shadow: 0.5em -1em rgba(61, 184, 143, 0.75),
          -0.5em 1em rgba(233, 169, 32, 0.75);
      }

      100% {
        box-shadow: 0.5em 1em rgba(61, 184, 143, 0.75),
          -0.5em -1em rgba(233, 169, 32, 0.75);
      }
    }
  </style>
</head>

<body>
  <div id='grafHostLoadingContainer'>
    <div id='grafHostLoading'>
      <div id='grafLoading' class="loader"></div>
    </div>
  </div>
  <script>
    function isInApp() {
      return window.navigator.userAgent.indexOf("TeldIosWebView") !== -1
        || window.navigator.userAgent.indexOf("TeldAndroidWebView") !== -1;
    }

    function parseQueryString(url) {
      var arr;
      var res = {};
      //#符号之后的值称为hash，都不会加到request请求中去
      url = url.split('#')[0];
      //获取queryString 第一个？号后面的全是查询字符串
      arr = url.split('?');
      arr.shift();
      var queryStr = arr.join('?');
      //查询字符串为空直接返回 避免出现这样的返回值{"":""}
      if (queryStr.trim().length == 0) {
        return res;
      }

      //获取参数
      arr = queryStr.split('&');
      for (var i = 0; i < arr.length; i++) {
        var itemArr = arr[i].split('=');
        //第一个=号之前的是name 后面的全是值
        var name = itemArr.shift();
        var value = itemArr.join('=');
        res[name] = value;
      }
      return res;
    }

    var qs = parseQueryString(window.location.search);
    if (isInApp() || qs.ltop) {
      var ltop = qs.ltop || '50px';
      document.getElementById("grafHostLoading").style.top = ltop;
    }
  </script>

  <grafana-app ng-cloak class="grafana-app _[[.User.ThemeName]]">

    <aside class="sidemenu-wrapper">
      <sidemenu ng-if="contextSrv.sidemenu"></sidemenu>
    </aside>

    <div ng-cloak class="page-alert-list">
      <div ng-repeat='alert in dashAlerts.list' class="alert-{{alert.severity}} alert">
        <button type="button" class="alert-close" ng-click="dashAlerts.clear(alert)">
          <i class="fa fa-times-circle"></i>
        </button>
        <div class="alert-title">{{alert.title}}</div>
        <div ng-bind='alert.text'></div>
      </div>
    </div>

    <div ng-view class="main-view"></div>
    <footer class="footer" style="display:none;">
      <div class="row text-center">
        <ul>
          <li>
            <a href="http://docs.grafana.org" target="_blank">
              <i class="fa fa-file-code-o"></i>
              Docs
            </a>
          </li>
          <li>
            <a href="https://grafana.com/services/support" target="_blank">
              <i class="fa fa-support"></i>
              Support Plans
            </a>
          </li>
          <li>
            <a href="https://community.grafana.com/" target="_blank">
              <i class="fa fa-comments-o"></i>
              Community
            </a>
          </li>
          <li>
            <a href="https://grafana.com" target="_blank">Grafana</a>
            <span>v[[.BuildVersion]] (commit: [[.BuildCommit]])</span>
          </li>
          [[if .NewGrafanaVersionExists]]
          <li>
            <a href="https://grafana.com/get" target="_blank" bs-tooltip="'[[.NewGrafanaVersion]]'">
              New version available!
            </a>
          </li>
          [[end]]
        </ul>
      </div>
    </footer>
  </grafana-app>

  <div style="display: none;">
    <script>
      window.grafanaBootData = {
        user: [[.User]],
        settings: [[.Settings]],
        mainNavLinks: [[.MainNavLinks]]
      };
    </script>
  </div>

  <!-- <script type="text/javascript" src="//api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script> -->
  <!-- build:js [[.AppSubUrl]]/public/app/boot.js -->
  <script src="[[.AppSubUrl]]/public/vendor/npm/es6-shim/es6-shim.js"></script>
  <script src="[[.AppSubUrl]]/public/vendor/npm/systemjs/dist/system.src.js"></script>
  <script src="[[.AppSubUrl]]/public/app/system.conf.js"></script>
  <script src="[[.AppSubUrl]]/public/app/boot.js"></script>
  <!-- endbuild -->

  <script>
    if (window.parent !== window) {
      $(document).on('keydown', function (e) {
        var e = event || window.event || arguments.callee.caller.arguments[0];
        if (e && e.keyCode == 122) { //捕捉F11键盘动作
          console.log('grafana key F11')
          e.preventDefault(); //阻止F11默认动作
          window.parent.postMessage("fullScreen", "*")
        }
      });

      window.addEventListener("message", receiveMessage, false);
      function receiveMessage(event) {
        if (event.data === "fullScreen") {
          console.log(event.origin + 'key F11');
          window.parent.postMessage("fullScreen", "*");
          console.log(event.origin + 'emit fullScreen to parent');
        }
      }
    }
  </script>

  [[if .GoogleTagManagerId]]
  <script>
    dataLayer = [{
      'IsSignedIn': '[[.User.IsSignedIn]]',
      'Email': '[[.User.Email]]',
      'Name': '[[.User.Name]]',
      'UserId': '[[.User.Id]]',
      'OrgId': '[[.User.OrgId]]',
      'OrgName': '[[.User.OrgName]]',
    }];
  </script>
  <!-- Google Tag Manager -->
  <!--
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=[[.GoogleTagManagerId]]" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function (w, d, s, l, i) {
      w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', '[[.GoogleTagManagerId]]');</script>
  -->
  <!-- End Google Tag Manager -->
  [[end]]

</body>

</html>
